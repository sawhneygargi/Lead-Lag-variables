import os
import sys
import pandas as pd
import numpy


df = pd.read_csv(sys.argv[1])
idx= 'id' #MTurkID'

fl=["AMSleepTime","AMSleepQual","AMPosAff_M","AMNegAff_M","AmReatt_M","AmPosExpect_M","AmNegExpect_M","AM.P.Energy","AM.S.Energy","AM.M.Energy","AM.E.Energy","PMEng","PM.MB.relax","PM.MB.nut","PM.MB.soc","PM.MB.cog","PM.MicroBreaksSum","PMPosAff_M","PMNegAff_M","PMPhysSympSum","PMdetach_M","PMrelax_M","PMrelrem_M","PMsrim_M","PMposreflect_M","PMnegreflect_M","PM.P.Energy","PM.S.Energy","PM.M.Energy","PM.E.Energy","AMSleepTime_mean_g","AMSleepQual_mean_g","AMPosAff_M_mean_g","AMNegAff_M_mean_g","AmReatt_M_mean_g","AmPosExpect_M_mean_g","AmNegExpect_M_mean_g","AM.P.Energy_mean_g","AM.S.Energy_mean_g","AM.M.Energy_mean_g","AM.E.Energy_mean_g","PMEng_mean_g","PM.MB.relax_mean_g","PM.MB.nut_mean_g","PM.MB.soc_mean_g","PM.MB.cog_mean_g","PM.MicroBreaksSum_mean_g","PMPosAff_M_mean_g","PMNegAff_M_mean_g","PMPhysSympSum_mean_g","PMdetach_M_mean_g","PMrelax_M_mean_g","PMrelrem_M_mean_g","PMsrim_M_mean_g","PMposreflect_M_mean_g","PMnegreflect_M_mean_g","PM.P.Energy_mean_g","PM.S.Energy_mean_g","PM.M.Energy_mean_g","PM.E.Energy_mean_g","AMSleepTime_gmc","AMSleepQual_gmc","AMPosAff_M_gmc","AMNegAff_M_gmc","AmReatt_M_gmc","AmPosExpect_M_gmc","AmNegExpect_M_gmc","AM.P.Energy_gmc","AM.S.Energy_gmc","AM.M.Energy_gmc","AM.E.Energy_gmc","PMEng_gmc","PM.MB.relax_gmc","PM.MB.nut_gmc","PM.MB.soc_gmc","PM.MB.cog_gmc","PM.MicroBreaksSum_gmc","PMPosAff_M_gmc","PMNegAff_M_gmc","PMPhysSympSum_gmc","PMdetach_M_gmc","PMrelax_M_gmc","PMrelrem_M_gmc","PMsrim_M_gmc","PMposreflect_M_gmc","PMnegreflect_M_gmc","PM.P.Energy_gmc","PM.S.Energy_gmc","PM.M.Energy_gmc","PM.E.Energy_gmc"]
#'SleepQualMor','StateofRecMor','PosAffectMor','NegAffectMor','VigorPhyMor','VigorEmoMor','VigorCogMor','VigorOMor','InsomniaMor','FamPerfMor','StressAnticipateMor','ChalItem1Lun','ChalACItem1Lun','ChalAHItem1Lun','ChalItem2Lun','ChalACItem2Lun','ChalAHItem2Lun','ChalItem3Lun','ChalACItem3Lun','ChalAHItem3Lun','ChalItem4Lun','ChalACItem4Lun','ChalAHItem4Lun','ChalItem5Lun','ChalACItem5Lun','ChalAHItem5Lun','ChalItem6Lun','ChalACItem6Lun','ChalAHItem6Lun','HindItem1Lun','HindACItem1Lun','HindAHItem1Lun','HindItem2Lun','HindACItem2Lun','HindAHItem2Lun','HindItem3Lun','HindACItem3Lun','HindAHItem3Lun','HindItem4Lun','HindACItem4Lun','HindAHItem4Lun','HindItem5Lun','HindACItem5Lun','HindAHItem5Lun','HindItem6Lun','HindACItem6Lun','HindAHItem6Lun','HindItem7Lun','HindACItem7Lun','HindAHItem7Lun','ChallStressLun','ChalStressACLun','ChalStressAHLun','HindStressLun','HindStressACLun','HindStressAHLun','PosAffectLun','NegAffectLun','RoleOverloadLun','RoleAmbigLun','RoleClarityLun','RoleConflictLun','QuantDemandLun','CogDemandLun','EmoDemandLun','IncivilityLun','OrgConstraintsLun','AutonomyLun','DevOpporLun','SocialSupportLun','IllegitimateTaskLun','MicroBreaksLun','PosReattachEve','PosAffectEve','NegAffectEve','PhyVigorEve','EmoVigorEve','CogVigorEve','VigorOEve','WorkExcessiveEve','WorkCompulsiveEve','WorkaholismEve','MindfulnessEve','StateofRecEve','JobSatEve','PhyDetachEve','RecoveryGuiltEve','EngageVigEve','EngageDedEve','EngageAbsEve','EngageOEve','BurnoutEve','TaskPerfEve','TaskRotateEve','CogReappraiseEve','TurnoverIntentEve','WorkDurEve','PosAffectNig','NegAffectNig','PhyVigorNig','EmoVigorNig','CogVigorNig','VigorONig','FamQuantDemandNig','FamCogDemandNig','FamEmoDemandNig','FamSocialSupNig','FamAutonomyNig','FamDevelopNig','PsychDetachNig','RelaxNig','MasteryNig','ControlNig','WorkDisengageNig','PleasureNig','RecSatNig','PosRuminateNig','NegRuminateNig','WLSatNig','WFCTimeNig','WFCStrainNig','WFCONig','WFBEffectiveNig','FamEngageNig','PosWFSpillNig','NegWFSpillNig','WorkInterruptNig','FamPerfNig','SleepQualMor_mean','StateofRecMor_mean','PosAffectMor_mean','NegAffectMor_mean','VigorPhyMor_mean','VigorEmoMor_mean','VigorCogMor_mean','VigorOMor_mean','InsomniaMor_mean','FamPerfMor_mean','StressAnticipateMor_mean','ChalItem1Lun_mean','ChalACItem1Lun_mean','ChalAHItem1Lun_mean','ChalItem2Lun_mean','ChalACItem2Lun_mean','ChalAHItem2Lun_mean','ChalItem3Lun_mean','ChalACItem3Lun_mean','ChalAHItem3Lun_mean','ChalItem4Lun_mean','ChalACItem4Lun_mean','ChalAHItem4Lun_mean','ChalItem5Lun_mean','ChalACItem5Lun_mean','ChalAHItem5Lun_mean','ChalItem6Lun_mean','ChalACItem6Lun_mean','ChalAHItem6Lun_mean','HindItem1Lun_mean','HindACItem1Lun_mean','HindAHItem1Lun_mean','HindItem2Lun_mean','HindACItem2Lun_mean','HindAHItem2Lun_mean','HindItem3Lun_mean','HindACItem3Lun_mean','HindAHItem3Lun_mean','HindItem4Lun_mean','HindACItem4Lun_mean','HindAHItem4Lun_mean','HindItem5Lun_mean','HindACItem5Lun_mean','HindAHItem5Lun_mean','HindItem6Lun_mean','HindACItem6Lun_mean','HindAHItem6Lun_mean','HindItem7Lun_mean','HindACItem7Lun_mean','HindAHItem7Lun_mean','ChallStressLun_mean','ChalStressACLun_mean','ChalStressAHLun_mean','HindStressLun_mean','HindStressACLun_mean','HindStressAHLun_mean','PosAffectLun_mean','NegAffectLun_mean','RoleOverloadLun_mean','RoleAmbigLun_mean','RoleClarityLun_mean','RoleConflictLun_mean','QuantDemandLun_mean','CogDemandLun_mean','EmoDemandLun_mean','IncivilityLun_mean','OrgConstraintsLun_mean','AutonomyLun_mean','DevOpporLun_mean','SocialSupportLun_mean','IllegitimateTaskLun_mean','MicroBreaksLun_mean','PosReattachEve_mean','PosAffectEve_mean','NegAffectEve_mean','PhyVigorEve_mean','EmoVigorEve_mean','CogVigorEve_mean','VigorOEve_mean','WorkExcessiveEve_mean','WorkCompulsiveEve_mean','WorkaholismEve_mean','MindfulnessEve_mean','StateofRecEve_mean','JobSatEve_mean','PhyDetachEve_mean','RecoveryGuiltEve_mean','EngageVigEve_mean','EngageDedEve_mean','EngageAbsEve_mean','EngageOEve_mean','BurnoutEve_mean','TaskPerfEve_mean','TaskRotateEve_mean','CogReappraiseEve_mean','TurnoverIntentEve_mean','WorkDurEve_mean','PosAffectNig_mean','NegAffectNig_mean','PhyVigorNig_mean','EmoVigorNig_mean','CogVigorNig_mean','VigorONig_mean','FamQuantDemandNig_mean','FamCogDemandNig_mean','FamEmoDemandNig_mean','FamSocialSupNig_mean','FamAutonomyNig_mean','FamDevelopNig_mean','PsychDetachNig_mean','RelaxNig_mean','MasteryNig_mean','ControlNig_mean','WorkDisengageNig_mean','PleasureNig_mean','RecSatNig_mean','PosRuminateNig_mean','NegRuminateNig_mean','WLSatNig_mean','WFCTimeNig_mean','WFCStrainNig_mean','WFCONig_mean','WFBEffectiveNig_mean','FamEngageNig_mean','PosWFSpillNig_mean','NegWFSpillNig_mean','WorkInterruptNig_mean','FamPerfNig_mean','SleepQualMor_G','StateofRecMor_G','PosAffectMor_G','NegAffectMor_G','VigorPhyMor_G','VigorEmoMor_G','VigorCogMor_G','VigorOMor_G','InsomniaMor_G','FamPerfMor_G','StressAnticipateMor_G','ChalItem1Lun_G','ChalACItem1Lun_G','ChalAHItem1Lun_G','ChalItem2Lun_G','ChalACItem2Lun_G','ChalAHItem2Lun_G','ChalItem3Lun_G','ChalACItem3Lun_G','ChalAHItem3Lun_G','ChalItem4Lun_G','ChalACItem4Lun_G','ChalAHItem4Lun_G','ChalItem5Lun_G','ChalACItem5Lun_G','ChalAHItem5Lun_G','ChalItem6Lun_G','ChalACItem6Lun_G','ChalAHItem6Lun_G','HindItem1Lun_G','HindACItem1Lun_G','HindAHItem1Lun_G','HindItem2Lun_G','HindACItem2Lun_G','HindAHItem2Lun_G','HindItem3Lun_G','HindACItem3Lun_G','HindAHItem3Lun_G','HindItem4Lun_G','HindACItem4Lun_G','HindAHItem4Lun_G','HindItem5Lun_G','HindACItem5Lun_G','HindAHItem5Lun_G','HindItem6Lun_G','HindACItem6Lun_G','HindAHItem6Lun_G','HindItem7Lun_G','HindACItem7Lun_G_','HindAHItem7Lun_G','ChallStressLun_G','ChalStressACLun_G','ChalStressAHLun_G','HindStressLun_G','HindStressACLun_G','HindStressAHLun_G','PosAffectLun_G','NegAffectLun_G','RoleOverloadLun_G','RoleAmbigLun_G','RoleClarityLun_G','RoleConflictLun_G','QuantDemandLun_G','CogDemandLun_G','EmoDemandLun_G','IncivilityLun_G','OrgConstraintsLun_G','AutonomyLun_G','DevOpporLun_G','SocialSupportLun_G','IllegitimateTaskLun_G','MicroBreaksLun_G','PosReattachEve_G','PosAffectEve_G','NegAffectEve_G','PhyVigorEve_G','EmoVigorEve_G','CogVigorEve_G','VigorOEve_G','WorkExcessiveEve_G','WorkCompulsiveEve_G','WorkaholismEve_G','MindfulnessEve_G','StateofRecEve_G','JobSatEve_G','PhyDetachEve_G','RecoveryGuiltEve_G','EngageVigEve_G','EngageDedEve_G','EngageAbsEve_G','EngageOEve_G','BurnoutEve_G','TaskPerfEve_G','TaskRotateEve_G','CogReappraiseEve_G','TurnoverIntentEve_G','WorkDurEve_G','PosAffectNig_G','NegAffectNig_G','PhyVigorNig_G','EmoVigorNig_G','CogVigorNig_G','VigorONig_G','FamQuantDemandNig_G','FamCogDemandNig_G','FamEmoDemandNig_G','FamSocialSupNig_G','FamAutonomyNig_G','FamDevelopNig_G','PsychDetachNig_G','RelaxNig_G','MasteryNig_G','ControlNig_G','WorkDisengageNig_G','PleasureNig_G','RecSatNig_G','PosRuminateNig_G','NegRuminateNig_G','WLSatNig_G','WFCTimeNig_G','WFCStrainNig_G','WFCONig_G','WFBEffectiveNig_G','FamEngageNig_G','PosWFSpillNig_G','NegWFSpillNig_G','WorkInterruptNig_G','FamPerfNig_G']

for r in fl:
	df[r+'Plus1'] = df[r].shift(periods=1,fill_value='')
	df[r+'Minus1'] = df[r].shift(periods=-1,fill_value='')
	for i in range(len(df[r])):
		if i % 5 == 0:
			df[r+'Plus1'][i] = ''
	for i in range(len(df[r]) + 1):
		if i == 0:
			continue
		if i % 5 == 0:
			df[r+'Minus1'][i-1] = ''
print(df.to_csv())
